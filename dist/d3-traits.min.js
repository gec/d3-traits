/*! d3-traits - v0.0.1 - 2014-07-03
* https://github.com/gec/d3-traits
* Copyright (c) 2014 d3-traits; Licensed ,  */
!function(a){function b(a,b){for(var c in a)c in b||(b[c]=a[c])}function c(a,b){var c=a[b];return c||(a[b]={},c=a[b]),c}function d(a){return"x"===a.charAt(0)}function e(a){return"y"===a.charAt(0)}function f(a){return a[0]}function g(a){return a[a.length-1]}function h(b,c){return a.max(b,function(a){return c(a).length})>0}function i(a){return"[object Date]"!==Object.prototype.toString.call(a)?!1:!isNaN(a.getTime())}function j(b,c){return a.trait.utils.isX(c)?[b.minRangeMarginLeft(c),b.chartWidth()-b.minRangeMarginRight(c)]:[b.chartHeight()-b.minRangeMarginBottom(c),b.minRangeMarginTop(c)]}function k(b,c,d){var e=d.domain();return a.trait.utils.isX(c)?[[0,d(e[0])],[d(e[1]),b.chartWidth()]]:[[0,d(e[0])],[d(e[1]),b.chartHeight()]]}function l(a,b){var c=parseFloat(a);return isNaN(c)?b:c}function m(a,b){if(!a)return b;var c={};return c.top=l(a.top,b.top),c.right=l(a.right,b.right),c.bottom=l(a.bottom,b.bottom),c.left=l(a.left,b.left),c}function n(a){if(null==a||"object"!=typeof a)return a;var b=a.constructor();for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);return b}function o(){var a,b,c,d,e=arguments[0]||{},f=arguments.length;for(a=1;f>a;a++)if(null!=(b=arguments[a]))for(c in b)d=b[c],d&&(e[c]=d);return e}function p(a,b){for(var c in b)a.hasOwnProperty(c)||b[c]&&(a[c]=b[c]);return a}function q(a,b){var c=n(a);return c||(c={}),p(c,b)}function r(a,b,c){function d(a,b){return"_"+a+"_"+b}function e(a,b,c){return t&&console.log("makeVirtual "+a),function(a,b){return function(){var a=this._super;this._super=c;var d=b.apply(this,arguments);return this._super=a,d}}(a,b)}t&&console.log("trait( "+a.name+")");var f,g,h=this;h.config=b,h._super=c,h.index=-1,h.__leafTrait=null,h.getImp=function(){return g},h.trait=function(a,b){var c=new r(a,b,g);return c.getImp()},h.call=function(a,b){return b||(b=this),this.__leafTrait||(this.__leafTrait=b),this._super&&this._super.call(a,b),a.call(g),g},h.callTraits=function(a){return this.__leafTrait?this.__leafTrait.call(a):this},h.__replaceVirtual=function(a,b){g.hasOwnProperty(a)&&(g[a]=b),c&&c.__replaceVirtual(a,b)},h.__virtualize=function(b,d){t&&console.log("__virtualize begin "+a.name+" name="+b);var f=null;return g.hasOwnProperty(b)&&"function"==typeof g[b]?(t&&console.log("__virtualize "+a.name+" name="+b+" hasFunction"),f=e(b,d,g[b]),g[b]=f,c&&c.__replaceVirtual(b,f)):t&&console.log("__virtualize "+a.name+" name="+b+" hasFunction NOT  "),f},h.__makeVTable=function(){t&&console.log("__makeVTable begin "+a.name);var b,d;for(b in g)d=c.__virtualize(b,g[b]),d?(t&&console.log(a.name+".__makeVTable name "+b+"   virtualized"),g[b]=d):t&&console.log(a.name+".__makeVTable name "+b+" ! virtualized");for(b in c)b in g||(g[b]=c[b]);t&&console.log("__makeVTable end")},h.__getRoot=function(){return h._super?h._super.__getRoot():h},f=d(a.name,h._traitIndex),c&&(h.config=q(b,h.__getRoot().config)),g=a(c,h.config,f),c&&h.__makeVTable(),g.call=h.call,g.callTraits=h.callTraits,g.trait=h.trait,g.getImp=h.getImp,g.config=h.config,g.__makeVTable=h.__makeVTable,g.__virtualize=h.__virtualize,g.__replaceVirtual=h.__replaceVirtual,g.__getRoot=h.__getRoot,g._super=c}function s(a,b){return new r(a,b).getImp()}var t=!1;Array.isArray=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},r.prototype={trait:function(a,b){var c=new r(a,b,this),d=c.getImp();return d},__getRoot:function(){return this._super?this._super.__getRoot():this},callInstance:function(a){var b=this;a.call(function(a){a.each(function(c){b(c,a)})})},call:function(a,b){return b||(b=this),this.__leafTrait=b,this._super&&this._super.call(a,b),a.call(this),this}},r.prototype.constructor=r,a.selection.prototype.trait=function(a,c){if(Array.isArray(a))for(var d in a)this.trait(a[d]);else{this._traitsInitialize();var e=this.traits.length,f={};e>0&&(f=this.traits[e-1]);var g=q(this._traitsConfig,c),h=a(f,g,this);b(f,h),this.call(h),this.traits.push(h)}return this},a.selection.prototype.callTraits=function(){for(var a in this.traits){var b=this.traits[a];this.call(b)}return this};var u={};a.selection.prototype._traitsInitialize=function(){return this._traitsConfig||(this._traitsConfig=n(u)),this.traits||(this.traits=[]),this},a.selection.prototype.traitConfig=function(a){this._traitsInitialize();for(var b in a)this._traitsConfig[b]=a[b];return this},a.trait=s,a.trait.scale={},a.trait.chart={utils:{}},a.trait.axis={},a.trait.control={},a.trait.focus={},a.trait.legend={},a.trait.utils={clone:n,extend:o,isX:d,isY:e,isData:h,isValidDate:i,extentMin:f,extentMax:g,getScaleRange:j,getScaleExtensions:k,getTraitCache:c,configMargin:m,configFloat:l}}(d3),function(a,b){function c(a,b){arguments.length<=0?(this.x=0,this.y=0):(this.x=a,this.y=b)}function d(a,b){arguments.length<=0?(this.width=0,this.height=0):(this.width=a,this.height=b)}function e(){var a,b;switch(arguments.length){case 0:this.top=0,this.right=0,this.bottom=0,this.left=0;break;case 1:a=arguments[0],this.top=a,this.right=a,this.bottom=a,this.left=a;break;case 2:a=arguments[0],b=arguments[1],this.top=a,this.right=b,this.bottom=a,this.left=b;break;case 3:this.top=arguments[0],this.right=arguments[1],this.bottom=arguments[2],this.left=arguments[1];break;case 4:this.top=arguments[0],this.right=arguments[1],this.bottom=arguments[2],this.left=arguments[3]}}function f(a,b,e,f,g,h){switch(arguments.length){case 0:this.origin=new c(0,0),this.size=new d(0,0),this.anchor=new c(0,0);break;case 2:this.origin=new c(a.x,a.y),this.size=new d(b.width,b.height),this.anchor=new c(0,0);break;case 3:this.origin=new c(a.x,a.y),this.size=new d(b.width,b.height),this.anchor=new c(e.x,e.y);break;case 4:this.origin=new c(a,b),this.size=new d(e,f),this.anchor=new c(0,0);break;case 6:this.origin=new c(a,b),this.size=new d(e,f),this.anchor=new c(g,h)}this.minX=function(){return this.origin.x-this.size.width*this.anchor.x},this.maxX=function(){return this.origin.x+this.size.width*(1-this.anchor.x)},this.minY=function(){return this.origin.y-this.size.height*this.anchor.y},this.maxY=function(){return this.origin.y+this.size.height*(1-this.anchor.y)},this.spaceOnTop=function(a){return this.minY()-a.maxY()},this.spaceOnBottom=function(a){return a.minY()-this.maxY()},this.roomOnRight=function(a){return a.maxX()-this.maxX()},this.roomOnBottom=function(a){return a.maxY()-this.maxY()},this.roomOnLeft=function(a){return this.minX()-a.minX()},this.roomOnTop=function(a){return this.minY()-a.minY()},this.translate=function(a){this.origin.x+=a.x,this.origin.y+=a.y}}function g(a,b){return a.rect.origin.y-b.rect.origin.y}function h(a,b){for(var c=null,d=a.length-1;d>=0;d--){var e,f=a[d],g=f.rect;e=d===a.length-1?b-g.maxY():c.rect.spaceOnTop(g),0>e&&(g.origin.y+=e),c=f}}function i(a,b,c){var d=0;c>0?d=-c-b:0>b&&(d=-b),a.origin.y+=d}function j(a,b,c){var d,e=null;a.forEach(function(a,f){d=a.rect,0===f?i(d,d.roomOnTop(b),c):i(d,d.spaceOnTop(e.rect),c),e=a})}function k(a,b,c,d){for(var e,f=b;c>f;f++)e=a[f],e.rect.origin.y+=d}function l(a,b,c){for(var d,e,f,g=0,h=0,i=0,j=0,l=null,m=0,n=0;g<a.length;g++){if(f=a[g],d=f.rect,e=0===g?d.roomOnTop(b):d.spaceOnTop(l.rect),e>0)if(i>0){if(n=m/i,-1>n||n>1){var o=n;n=n>0?Math.min(n,j):-Math.min(-n,e),k(a,h,g,-n),j-=n,e+=n,e>0?(i=1,h=g,j=e,m=0):(m=(o-n)*i,i++,m+=d.origin.y-c[g])}}else i=1,h=g,j=e,m+=d.origin.y-c[g];else i++,m+=d.origin.y-c[g];l=f}if(i>1&&(n=m/i,-1>n||n>1)){if(n>0)n=Math.min(n,j);else{var p=l.rect.roomOnBottom(b);n=p>0?-Math.min(-n,p):0}k(a,h,g,-n)}}function m(b,c){if(!(b.length<=0)){b.sort(g);var d=0,e=0,f=c.size.height,i=a.sum(b,function(a){return a.rect.size.height}),k=b.map(function(a){return a.rect.origin.y});i>f?e=(i-f)/b.length:d=f-i,j(b,c,e),d>0&&(h(b,c.maxY()),l(b,c,k))}}function n(a,b){var c,d=[],e=[];return a.forEach(function(a){c=a.rect,c.anchor.x<.5?c.roomOnRight(b)>=0?(a.orient=r,e.push(a)):(a.orient=q,c.anchor.x=1,d.push(a)):c.roomOnLeft(b)>=0?(a.orient=q,d.push(a)):(a.orient=r,c.anchor.x=0,e.push(a))}),[d,e]}function o(a,b){var c=n(a,b);m(c[0],b),m(c[1],b)}function p(a,b,c,d){var e,f,g=0;switch(c){case"left":g=b.minX(),a.forEach(function(a){e=a.rect,e.origin.x+=g-e.minX(),g=e.maxX()});break;case"right":for(g=b.maxX(),f=a.length-1;f>=0;f--)e=a[f].rect,e.origin.x+=g-e.maxX(),g=e.minX();break;case"top":g=b.minY(),a.forEach(function(a){e=a.rect,e.origin.y+=g-e.minY(),g=e.maxY()});break;case"bottom":for(g=b.maxY(),f=a.length-1;f>=0;f--)e=a[f].rect,e.origin.y+=g-e.maxY(),g=e.minY()}}var q=-1,r=1;b.layout||(b.layout={utils:{}}),b.Point=c,b.Size=d,b.Margin=e,b.Rect=f,b.layout.adjustOrientationToFitWidth=n,b.layout.vertical=m,b.layout.byOrientation=p,b.layout.verticalAnchorLeftRight=o,b.layout.utils.listNudgeUpFromBottom=h,b.layout.utils.removeOverlapFromTop=j,b.layout.utils.listBalanceFromTop=l}(d3,d3.trait),function(a,b){function c(a,b){return b?b:"x"===a?"bottom":"left"}function d(a){var b=a.axis,d=b.charAt(0),e={name:b,axisChar:d,accessData:a[b],orient:c(d,a.orient),ticks:a.ticks,extentTicks:a.extentTicks||!1,tickSize:a.tickSize,tickPadding:a.tickPadding,tickFormat:a.tickFormat,nice:a.nice,label:a.label};return e.labelLineHeight=e.label?a.labelLineHeight||14:0,e.axisMargin=a.axisMargin||40+e.labelLineHeight,e}function e(a,b,c){if(!b.label)return null;var d,e,f=c.node().getBBox(),g=Math.round(f.width/2);switch(b.axisMargin-b.labelLineHeight,b.orient){case"left":return d=-b.axisMargin+b.labelLineHeight,e=a.chartHeight()/2+g,"translate( "+d+","+e+") rotate( -90)";case"bottom":return d=a.chartWidth()/2-g,e=b.axisMargin-b.labelLineHeight,"translate( "+d+","+e+")";case"top":return d=a.chartWidth()/2-g,e=-b.axisMargin+b.labelLineHeight,"translate( "+d+","+e+")";case"right":return d=b.axisMargin-b.labelLineHeight,e=a.chartHeight()/2-g,"translate( "+d+","+e+") rotate( 90)";default:return null}}function f(a,b,c){c.extentTicks?a.tickValues(b.domain()):c.ticks&&a.ticks(c.ticks),c.tickSize&&a.tickSize(c.tickSize),c.tickPadding&&a.tickPadding(c.tickPadding),c.tickFormat&&a.tickFormat(c.tickFormat)}function g(b,c){function g(c){var d=g;c.each(function(){if(h||(h=this._container.append("g").classed("axis",!0),i=h.append("g").classed("axis-"+l.name,!0),l.label&&(j=h.append("text").classed("axis-label axis-label-"+l.name,!0)),k=a.svg.axis()),k.scale(m).orient(l.orient),f(k,m,l),d.layoutAxis(h,l.orient,l.axisMargin),l.label&&(j.text(l.label),j.attr({transform:e(d,l,j)})),i.call(k),b.isMinRangeMargin(l.name)){var c=a.trait.utils.getScaleExtensions(b,l.name,m),g=i.selectAll("path.axis-extension").data(c);g.enter().append("path").attr("class","axis-extension").attr("d",function(a){return"M"+a[0]+",0L"+a[1]+",0"}),g.transition().duration(0).attr("class","axis-extension").attr("d",function(a){return"M"+a[0]+",0L"+a[1]+",0"})}})}var h,i,j,k,l=d(c),m=b[l.name]();return g.update=function(a,c){return this._super(a,c),f(k,m,l),0===c?i.call(k):i.transition().duration(c||b.duration()).ease("linear").call(k),this},b.onRangeMarginChanged("axisLinear-"+l.name,g),g}function h(b,c){function g(b){var d=g;b.each(function(b){i||(i=this._container.append("g").classed("axis",!0),j=i.append("g").classed("axis-"+o.name,!0),o.label&&(k=i.append("text").classed("axis-label axis-label-"+o.name,!0)),m=a.svg.axis());var g=p.domain();n.range(p.range()),n.domain(p.domain()),o.nice&&n.nice(o.nice),m.scale(n).orient(o.orient),f(m,n,o),d.layoutAxis(i,o.orient,o.axisMargin),o.label&&(k.text(o.label),k.attr({transform:e(d,o,k)})),i.call(m);var h=i.selectAll("path.axis-extension").data(a.trait.utils.isValidDate(g[0])?[g[0]]:[]);h.transition().attr("class","axis-extension").attr("d",function(a){return"M0,0L"+n(a)+",0"}),h.enter().append("path").attr("class","axis-extension").attr("d",function(a){return"M0,0L"+n(a)+",0"}),a.trait.utils.isData(b,c.seriesData)&&(l=a.trait.utils.extentMax(g))})}function h(){var b=p.domain(),c=a.trait.utils.extentMin(b),d=a.trait.utils.extentMax(b);if(l){var e=l.getTime();if(e>c.getTime()){var f=d.getTime()-e;c=new Date(c.getTime()+f)}}return[c,d]}var i,j,k,l,m=a.svg.axis(),n=a.time.scale(),o=d(c),p=b[o.name]();return g.update=function(c,d){this._super(c,d),n.range(a.trait.utils.getScaleRange(b,o.name));var e=h();return n.domain(e),l=a.trait.utils.extentMax(e),0===d?i.call(m):i.transition().duration(d||b.duration()).ease("linear").call(m),this},b.onChartResized("axisMonth-"+o.name,g),b.onRangeMarginChanged("axisMonth-"+o.name,g),g}b.axis.linear=g,b.axis.time||(b.axis.time={}),b.axis.time.month=h}(d3,d3.trait),function(a,b){function c(c,d){function e(b){var c=e;b.each(function(b){if(!f){var e=d.chartClass?"chart-area "+d.chartClass:"chart-area";f=this._chartGroup.append("g").classed(e,!0)}var j=d.seriesFilter?b.filter(d.seriesFilter):b;k.y0(c.chartHeight()),g=f.selectAll(".series").data(j),g.selectAll("path").transition().duration(500).attr("d",function(a){return k(d.seriesData(a))}),g.enter().append("g").attr("class","series").append("path").attr("class","area").attr("d",function(a){return k(d.seriesData(a))}).style("fill",c.color),h=a.trait.utils.extentMax(i.domain())})}var f,g,h,i=c.x1(),j=c.y1(),k=a.svg.area().interpolate(d.interpolate||"linear").x(function(a){return i(d.x1(a))}).y0(c.chartHeight()).y1(function(a){return j(d.y1(a))}),l=a.dispatch("customHover");return e.update=function(a,e){this._super(a,e);var f=e||c.duration(),j=function(a){return k(d.seriesData(a))};return h=b.chart.utils.updatePathWithTrend(a,f,i,g,j,h),this},a.rebind(e,l,"on"),e}b.chart.area=c}(d3,d3.trait),function(a,b){function c(b){var c=a.trait.utils.configFloat(b.gap,.1),d=a.trait.utils.configFloat(b.outerGap,c),e={width:b.width||"auto",gap:c,outerGap:d,justification:b.justification||"center",insets:b.insets||k};return e}function d(a,b,c,d,e){return{x:function(c){return d(a.x1(c))+b.offset},y:function(b){return e(a.y1(b))},width:b.width,height:function(b){return c-e(a.y1(b))}}}function e(a,b,c){var d=0;switch(a){case"left":d=Math.round(c/2);break;case"right":d=Math.round(0-b-c/2);break;default:d=0-Math.round(b/2)}return d}function f(a,b,c,d,f,g,h,i){var j,k,l,m=e(i,f,g)-h,n=e(i,f,g)+f+h;return b?(j=b[0],k=d(c(a[j],j))+m,j=b[1],l=d(c(a[j],j))+n,[Math.floor(k),Math.ceil(l)]):d.range()}function g(b,c,d,e,g,h,i,j,k){var l=b.map(function(a,b){return f(d(a),c[b],e,g,h,i,j,k)}),m=a.min(l,function(a){return a[0]}),n=a.min(l,function(a){return a[1]});return[m,n]}function h(c,d,f,h,i,l){var m,n=null,o=null,p=0,q=0;if(i.rangeBand)m="auto"===h.width?i.rangeBand():h.width;else{var r=i.domain(),s=c.map(function(a){return b.chart.utils.dataIndicesExtentForDomainExtent(d(a),f,r)}),t=a.min(c,function(a,c){return b.chart.utils.minDistanceBetween(d(a),s[c],f,i)});m="auto"===h.width?Math.max(1,Math.floor(t*(1-h.gap))):h.width,p=Math.round(m*h.gap),q=Math.floor(m*h.outerGap);var u=g(c,s,d,f,i,m,p,q,h.justification),v=u[0],w=u[1];if(0>v||w>l)if(h.insets===k){var x=Math.max(w,l)-Math.min(0,v),y=l/x;"auto"===h.width&&(m=Math.max(1,Math.floor(m*y)),p=Math.round(m*h.gap),q=Math.floor(m*h.outerGap)),h.insets===k&&(u=g(c,s,d,f,i,m,p,q,h.justification),v=u[0],w=u[1],(0>v||w>l)&&(n={},0>v&&(n.left=1-v),w>l&&(n.right=w-l)))}else if(h.insets===j){var z=0>v?i.invert(v):r[0],A=w>l?i.invert(w):r[r.length-1];o=[z,A]}}var B=e(h.justification,m,p);return{width:m,gap:p,outerGap:q,offset:B,domainExtent:o,minRangeMargin:n}}function i(b,e){function f(c){var q=f;c.each(function(c){var f=b.chartWidth(),r=e.seriesFilter?c.filter(e.seriesFilter):c;if(k=h(r,e.seriesData,e.x1,p,m,f),(k.minRangeMargin||k.domainExtent)&&(k.minRangeMargin?q.minRangeMargin("x1",k.minRangeMargin):k.domainExtent&&b.x1Domain(k.domainExtent),k=h(r,e.seriesData,e.x1,p,m,f)),!g){var s=e.chartClass?"chart-bar "+e.chartClass:"chart-bar";g=this._chartGroup.append("g").classed(s,!0)}i=g.selectAll(".series").data(r),i.enter().append("g").attr("class","series").style("fill",q.color),j=i.selectAll("rect").data(e.seriesData),j.enter().append("rect").classed("bar",!0).attr(d(e,k,q.chartHeight(),m,n)).on("mouseover",o.customHover),j.transition().duration(0).delay(0).ease(q.ease()).attr(d(e,k,q.chartHeight(),m,n)),j.exit().transition().style({opacity:0}).remove(),l=a.trait.utils.extentMax(m.domain())})}var g,i,j,k,l,m=b.x1(),n=b.y1(),o=(e.barCount,a.dispatch("customHover")),p=c(e);return"function"==typeof m.rangeBand,f.update=function(c,f){this._super(c,f);var g=a.trait.utils.extentMax(m.domain()),h=m(l)-m(g);return i.attr("transform",null),j.attr(d(e,k,b.chartHeight(),m,n)),j=i.selectAll("rect").data(e.seriesData),j.enter().append("rect").classed("bar",!0).attr(d(e,k,b.chartHeight(),m,n)),j.exit().transition().style({opacity:0}).remove(),0===f?i.attr("transform","translate("+h+")"):i.transition().duration(f||b.duration()).ease("linear").attr("transform","translate("+h+")"),l=a.trait.utils.extentMax(m.domain()),this},a.rebind(f,o,"on"),f}var j="extend-domain",k="inset-range";b.chart.bar=i,b.chart.barUtils={barConfig:c,barAttr:d,barOffsetForJustification:e,rangeExtentOfBarsAndOuterGapForOneSeries:f,rangeExtentOfBarsAndOuterGap:g,getBarDimensions:h}}(d3,d3.trait),function(a,b){function c(c,e){function f(a){E[a]||(E[a]=b.utils.clone(G))}function g(b){if(!E[b])return!1;var c=E[b];return a.trait.utils.isX(b)?0!==c.left||0!==c.right:0!==c.top||0!==c.bottom}function h(a,b){if(!arguments.length)return{};if(f(a),1===arguments.length)return E[a];if(!b)return this;var c=E[a],d=!1;return b.left&&c.left<b.left&&(c.left=b.left,d=!0),b.right&&c.right<b.right&&(c.right=b.right,d=!0),b.top&&c.top<b.top&&(c.top=b.top,d=!0),b.bottom&&c.bottom<b.bottom&&(c.bottom=b.bottom,d=!0),d&&X.rangeMarginChanged(),this}function i(a,b){var c="chart-group-clip-path-"+d;return a._chartGroupClipPath=b.append("clipPath").attr("id",c),a._chartGroupClipPathRect=a._chartGroupClipPath.append("rect").attr("width",P).attr("height",Q),d++,c}function j(a,b,c){return a[0]>=0&&a[0]<=b&&a[1]>=0&&a[1]<=c}function k(a,b,c){return a?c:b}function l(a,b,c,d){return a?d.indexOf("%")>=0?d:c:b}function m(a,b,c,d){var e={};return e.width=l(b,c,a.offsetWidth,a.style.width),e.height=l(b,d,a.offsetHeight,a.style.height),e}function n(b,c,d,e){return new a.trait.Size(k(c,d,b.offsetWidth),k(c,e,b.offsetHeight))}function o(b){var c=o;J=b,b.each(function(b){var d=this,f=m(d,L,N,O);if(I=a.select(d),!d._svg){d._svg=a.select(d).append("svg").classed("chart",!0).attr("width",f.width).attr("height",f.height),d._svgDefs=d._svg.append("defs"),M=n(d,L,N,O),N=M.width,O=M.height,P=M.width-D.left-D.right,Q=M.height-D.top-D.bottom;var g=null;e.clip&&(g=i(d,d._svgDefs)),d._container=d._svg.append("g").classed("container-group",!0),d._chartGroup=d._container.append("g").classed("chart-group",!0),e.clip&&d._chartGroup.attr("clip-path","url(#"+g+")"),this._svg.on("mousemove",function(){var b,e=a.mouse(d._chartGroup.node()),f=j(e,P,Q),g=new a.trait.Point(e[0],e[1]);b=f?c.getFocusItems.call(d,g):[],b.forEach(function(a){a.point.x+=D.left,a.point.y+=D.top}),p(d,b)&&q(d,b,g),d.__onFocusChangeLastFoci=b}),this._svg.on("mouseout",function(){var b=a.mouse(d._chartGroup.node()),c=j(b,P,Q);c||r(d)}),T=[],b.forEach(function(a){var b;a.__color__&&(b=T.indexOf(a.__color__),b>=0?delete a.__color__:T.push(a.__color__))})}d._svg.transition().duration(U).attr({width:N,height:O}),d._svg.select(".chart-group").attr("transform","translate("+D.left+","+D.top+")"),e.clip&&d._chartGroupClipPathRect.attr("width",P).attr("height",Q),U=500})}function p(a,b){var c=a.__onFocusChangeLastFoci;if(!c||c.length!==b.length)return!0;for(var d,e,f=c.length-1;f>=0;f--)if(d=c[f],e=b[f],d.index!==e.index||d.point.x!==e.point.x||d.point.y!==e.point.y)return!0;return!1}function q(a,b,c){s(a,"__onFocusChangeListeners",[b,c])}function r(a){s(a,"__onChartMouseOutListeners",[])}function s(a,b,c){if(a[b])for(var d,e=0,f=a[b],g=f.length;g>e;e++)d=f[e],d.apply(a,c)}function t(){var a={chartWidth:P,chartHeight:Q};P=N-D.left-D.right,Q=O-D.top-D.bottom,(a.chartWidth!==P||a.chartHeight!==Q)&&(J&&o.callTraits(J),X.chartResized())}function u(){var a={width:N,height:O};N=P+D.left+D.right,O=Q+D.top+D.bottom,(a.width!==N||a.height!==O)&&X.chartResized()}function v(a){var b,c,d=F.length;for(b=0;d>b;b++)if(c=F[b],c.axisGroup===a)return c;return null}function w(a,b){var c,d=!1;if(a.length<=0)return d;switch(b){case"left":c=a[a.length-1].rect.maxX(),D.left<c&&(D.left=c,d=!0);break;case"right":c=N-a[0].rect.minX(),D.right<c&&(D.right=c,d=!0);break;case"top":c=a[a.length-1].rect.maxY(),D.top<c&&(D.top=c,d=!0);break;case"bottom":c=O-a[0].rect.minY(),D.bottom<c&&(D.bottom=c,d=!0)}return d}function x(a){var b=!1;return a.forEach(function(a){a.rect.minY()<D.top&&(a.rect.origin.y=D.top,b=!0)}),b}function y(a){var b=!1;return a.forEach(function(a){a.rect.minX()<D.left&&(a.rect.origin.x=D.left,b=!0)}),b}function z(a,b){var c=!1,d=0,e=0;if(a.length<=0)return c;switch(b){case"left":c=x(a),d=a[a.length-1].rect.maxX(),d<D.left&&(e=D.left-d,a.forEach(function(a){a.rect.origin.x+=e}),c=!0);break;case"right":c=x(a),d=a[0].rect.minX(),d>N-D.right&&(e=N-D.right-d,a.forEach(function(a){a.rect.origin.x+=e}),c=!0);break;case"top":c=y(a),d=a[a.length-1].rect.maxY(),d<D.top&&(e=D.top-d,a.forEach(function(a){a.rect.origin.y+=e}),c=!0);break;case"bottom":c=y(a),d=a[0].rect.minY(),d>O-D.bottom&&(e=O-D.bottom-d,a.forEach(function(a){a.rect.origin.y+=e}),c=!0)}return c}function A(b,c){switch(b){case"left":return new a.trait.Rect(0,0,c,0,1,0);case"right":return new a.trait.Rect(0,0,c,0);case"top":return new a.trait.Rect(0,0,0,c,0,1);case"bottom":return new a.trait.Rect(0,0,0,c);default:return new a.trait.Rect}}function B(){var b,c,d=!1,e=new a.trait.Rect(0,0,N,O),f=["left","right","top","bottom"],g={};f.forEach(function(c){b=F.filter(function(a){return a.orient===c}),a.trait.layout.byOrientation(b,e,c),d=d||w(b,c),g[c]=b});for(c in g)b=g[c],z(b,c);d&&t()}function C(a){if(a.__color__)return a.__color__;for(var b,c=0;10>c&&(a.__color__=S(R++),b=T.indexOf(a.__color__),!(0>b));)c++;return T.push(a.__color__),a.__color__}e||(e={}),e.seriesData||(e.seriesData=function(a){return a}),e.seriesLabel||(e.seriesLabel=function(a,b){return"Series "+b}),e.x1||(e.x1=function(a){return a[0]}),e.y1||(e.y1=function(a){return a[1]});var D=a.trait.utils.configMargin(e.margin,{top:5,right:5,bottom:5,left:5});e.clip=void 0===e.clip||e.clip===!0;var E={},F=[],G={left:0,right:0,top:0,bottom:0};if(e.minRangeMargin)for(var H in e.minRangeMargin)h(H,e.minRangeMargin[H]);var I,J,K="cubic-in-out",L=!0,M=new a.trait.Size,N=200,O=100,P=N-D.left-D.right,Q=O-D.top-D.bottom,R=0,S=a.scale.category10(),T=[],U=0,V="chartResized",W="rangeMarginChanged",X=a.dispatch(V,W);return o.onFocusChange=function(a,b){a.__onFocusChangeListeners||(a.__onFocusChangeListeners=[]),b&&a.__onFocusChangeListeners.push(b)},o.onChartMouseOut=function(a,b){a.__onChartMouseOutListeners||(a.__onChartMouseOutListeners=[]),b&&a.__onChartMouseOutListeners.push(b)},o.remove=function(){J.each(function(){var a=this;a._svg&&(a._svg.remove(),delete a._svg,delete a._svgDefs,delete a._container,delete a._chartGroup,delete a._chartGroupClipPath,delete a._chartGroupClipPathRect,delete a.__onFocusChangeListeners,delete a.__onChartMouseOutListeners)})},o.layoutAxis=function(a,b,c){var d=v(a),e=A(b,c);d?(d.orient!==b||d.rect.size!==e.size)&&(d.orient=b,d.rect=e,B()):(d={axisGroup:a,orient:b,rect:e},F.push(d),B()),d.axisGroup.attr("transform","translate("+d.rect.origin.x+","+d.rect.origin.y+")")},o.getFocusItems=function(){return[]},o.update=function(){},o.select=function(){return I},o.color=function(a,b){switch(arguments.length){case 1:return C(a);case 3:return C(a);case 2:return a.__color__=b,this;default:return"black"}},o.width=function(a){return arguments.length?(L=!1,N=parseInt(a,10),t(),this):N},o.height=function(a){return arguments.length?(L=!1,O=parseInt(a,10),t(),U=0,this):O},o.marginTop=function(a){return arguments.length?(D.top=a,t(),this):D.top},o.marginBottom=function(a){return arguments.length?(D.bottom=a,t(),this):D.bottom},o.marginLeft=function(a){return arguments.length?(D.left=a,t(),this):D.left},o.marginRight=function(a){return arguments.length?(D.right=a,t(),this):D.right},o.plusMarginTop=function(a){return D.top+=parseInt(a,10),t(),this},o.plusMarginBottom=function(a){return D.bottom+=parseInt(a,10),t(),this},o.plusMarginLeft=function(a){return D.left+=parseInt(a,10),t(),this},o.plusMarginRight=function(a){return D.right+=parseInt(a,10),t(),this},o.chartRect=function(){return new a.trait.Rect(D.left,D.top,P,Q)},o.chartWidth=function(a){return arguments.length?(P=parseInt(a,10),u(),this):P},o.chartHeight=function(a){return arguments.length?(Q=parseInt(a,10),u(),this):Q},o.ease=function(a){return arguments.length?(K=a,this):K},o.duration=function(a){return arguments.length?(U=a,this):U},o.onChartResized=function(a,b){var c=V;a&&a.length>0&&(c=c+"."+a),X.on(c,function(){J&&J.call(b)})},o.minRangeMargin=h,o.isMinRangeMargin=g,o.minRangeMarginLeft=function(a,b){return arguments.length?1===arguments.length?E[a]?E[a].left:0:(f(a),E[a].left<b&&(E[a].left=b,X.rangeMarginChanged()),this):0},o.minRangeMarginRight=function(a,b){return arguments.length?1===arguments.length?E[a]?E[a].right:0:(f(a),E[a].right<b&&(E[a].right=b,X.rangeMarginChanged()),this):0},o.minRangeMarginTop=function(a,b){return arguments.length?1===arguments.length?E[a]?E[a].top:0:(f(a),E[a].top<b&&(E[a].top=b,X.rangeMarginChanged()),this):0},o.minRangeMarginBottom=function(a,b){return arguments.length?1===arguments.length?E[a]?E[a].bottom:0:(f(a),E[a].bottom<b&&(E[a].bottom=b,X.rangeMarginChanged()),this):0},o.onRangeMarginChanged=function(a,b){var c=W;a&&a.length>0&&(c=c+"."+a),b?X.on(c,function(){J&&J.call(b)}):X.on(c)},o}var d=1;b.chart.base=c}(d3,d3.trait),function(a,b){function c(c,d){function e(b){var c=e;b.each(function(b){if(!l){var e=d.chartClass?"chart-line "+d.chartClass:"chart-line";l=this._chartGroup.append("g").classed(e,!0)}n=d.seriesFilter?b.filter(d.seriesFilter):b,m=l.selectAll(".series").data(n),m.selectAll("path").transition().duration(500).attr("d",function(a){return u(g(d.seriesData(a),q,d.x1))}),m.enter().append("g").attr("class","series").append("path").attr("class","line").attr("d",function(a){return u(d.seriesData(a))}).style("stroke",c.color),m.exit().transition().style({opacity:0}).remove(),a.trait.utils.isData(n,d.seriesData)&&(o=a.trait.utils.extentMax(q.domain()))})}function f(a,b,c,d,e,f){var g,h;for(void 0===e&&(e=0),void 0===f&&(f=a.length-1);f>=e;)if(g=Math.floor((e+f)/2),h=b(a[g]),c>h)e=g+1;else{if(!(h>c))return g;f=g-1}return 0>d?0>e+d?0:e+d:f+d>=a.length?a.length-1:f+d}function g(b,c,d){var e,g,h,i,j=b.length-1,k=c.range(),l=a.trait.utils.extentMax(k);return e=c.invert(k[0]),g=c.invert(l),h=f(b,d,e,-1),i=f(b,d,g,1,h,j),i++,b.slice(h,i)}function h(a,b){return b.x>a.x?b.x-a.x:a.x-b.x}function i(a,b){return b.y>a.y?b.y-a.y:a.y-b.y}function j(a,b){var c=h(a,b),d=i(a,b);return Math.sqrt(c*c+d*d)}function k(b,c,e,f){var g,i,k,l;return g=c[e],i=new a.trait.Point(q(d.x1(g)),r(s.y(g))),k=j(i,f),l=h(i,f),{series:b,index:e,item:g,point:i,distance:k,distanceX:l}}var l,m,n,o,p=d.yAxis||"y1",q=c.x1(),r=c[p](),s={x:d.x1,y:d[p]},t=a.trait.chart.utils.configFocus(d),u=a.svg.line().interpolate(d.interpolate||"linear").x(function(a){return q(s.x(a))}).y(function(a){return r(s.y(a))});return e.update=function(a,e){this._super(a,e);var f=e||c.duration(),h=function(a){return u(g(d.seriesData(a),q,d.x1))};return o=b.chart.utils.updatePathWithTrend(a,f,q,m,h,o),this},e.getFocusItems=function(b){var c=e,f=this._super(b),g=new a.trait.Point(q.invert(b.x),r.invert(b.y)),h=a.bisector(d.x1).left;return n.forEach(function(a){var e,i,j=d.seriesData(a),l=h(j,g.x);if(l>=j.length&&(l=j.length-1),e=k(a,j,l,b),i=e.index-1,i>=0){var m=k(a,j,i,b);"x"===t.axis?m.distanceX<e.distanceX&&(e=m):m.distance<e.distance&&(e=m)}e.distance<=t.distance&&(e.color=c.color(a),f.push(e))}),f},e}b.chart.line=c}(d3,d3.trait),function(a,b){function c(a,b,c,d,e,f){return{x:function(c){return e(a.x1(c))+b},y:function(b){return f(a.y1(b))},width:c,height:function(b){return d-f(a.y1(b))}}}function d(a,b,c){return{cx:function(c){return b(a.x1(c))},cy:function(b){return c(a.y1(b))},r:8}}function e(b,e){function f(b){var c=f;b.each(function(b){var f=this,j=e.seriesFilter?b.filter(e.seriesFilter):b;if(!g){var k=e.chartClass?"chart-scatter "+e.chartClass:"chart-scatter";g=this._chartGroup.append("g").classed(k,!0)}h=g.selectAll(".series").data(j),h.enter().append("g").attr("class","series").style("fill",c.color),i=h.selectAll(o).data(e.seriesData),i.transition().duration(500).delay(500).ease(c.ease()).attr(d(e,m,n)),i.enter().append(o).classed("scatter-point",!0).attr(d(e,m,n)).on("mouseover",function(a){return f._svg.append("text").text("data: "+e.y1(a).toFixed(1)).attr("id","tooltip").attr("x",m(e.x1(a))+10).attr("y",n(e.y1(a))).attr("fill","black").attr("opacity",0).style("font-family","sans-serif").transition().attr("opacity",1)}).on("mouseout",function(){a.select(this).transition().duration(500).attr("fill","slateblue"),a.selectAll("#tooltip").transition().duration(500).attr("opacity",0).remove()}),i.exit().transition().style({opacity:0}).remove(),l=a.trait.utils.extentMax(m.domain())})}var g,h,i,j,k,l,m=b.x1(),n=b.y1(),o="circle",p=a.dispatch("customHover");return f.update=function(d,f){this._super(d,f);var g=a.trait.utils.extentMax(m.domain()),o=m(l)-m(g);return h.attr("transform",null),i.attr(c(e,k,j,b.chartHeight(),m,n)),i=h.selectAll("rect").data(e.seriesData),i.enter().append("rect").classed("bar",!0).attr(c(e,k,j,b.chartHeight(),m,n)),i.exit().transition().style({opacity:0}).remove(),0===f?h.attr("transform","translate("+o+")"):h.transition().duration(f||b.duration()).ease("linear").attr("transform","translate("+o+")"),l=a.trait.utils.extentMax(m.domain()),this},a.rebind(f,p,"on"),b.onRangeMarginChanged("chartScatter",f),f}b.chart.scatter=e}(d3,d3.trait),function(a,b){function c(b,c,d){if(!b)return 0;var e=a.trait.utils.extentMax(c),f=a.trait.utils.extentMin(c),g=d(b),h=d(f);return h>g?0:g-d(e)}function d(a,b){a.selectAll("path").attr("d",b).attr("transform",null)}function e(b,e,f,g,h,i){var j=f.domain(),k=a.trait.utils.extentMax(j);if("trend"===b){var l=c(i,j,f);0!==l?(g.attr("transform",null),g.selectAll("path").attr("d",h),0!==e&&e?g.transition().duration(e).ease("linear").attr("transform","translate("+l+")"):g.attr("transform","translate("+l+")")):d(g,h)}else d(g,h);return k}function f(b){var c={distance:14,axis:null};return b.focus&&(c.distance=a.trait.utils.configFloat(b.focus.distance,c.distance),c.axis=b.focus.axis),c}function g(a,b,c,d){var e=d.range(),f=e[e.length-1]-e[0],g=a.length;if(2>g||b.length<2)return f;var h=b[0],i=Math.min(g-1,b[1]);if(0>h||h>=g)return f;var j,k=d(c(a[h],h));for(h++;i>=h;h++)j=d(c(a[h],h)),f=Math.min(f,j-k),k=j;return f}function h(b,c,d){if(b.length<=0)return null;var e=a.trait.utils.extentMin(d),f=a.trait.utils.extentMax(d),g=a.bisector(c),h=g.left,i=g.right,j=h(b,e),k=i(b,f);return[j,k-1]}b.chart.utils.updatePathWithTrend=e,b.chart.utils.configFocus=f,b.chart.utils.minDistanceBetween=g,b.chart.utils.dataIndicesExtentForDomainExtent=h}(d3,d3.trait),function(a,b){function c(b,c){function d(){var a=m.empty()?j.domain():m.extent();k[l+"Domain"](a),k.update("domain",0)}function e(b){var d=e;b.each(function(){if(!f){var b="brush brush-"+h,e=c.chartClass?b+c.chartClass:b;f=this._chartGroup.append("g").classed(e,!0).call(m)}f.selectAll("rect").attr("y",-6).attr("height",d.chartHeight()+7),g=a.trait.utils.extentMax(j.domain())})}var f,g,h=c.axis,i=h.charAt(0),j=b[h](),k=c.target,l=c.targetAxis,m=(k[c.targetAxis](),a.svg.brush()[i](j));m.on("brush",d);var n=a.dispatch("customHover");return e.update=function(b,c){return this._super(b,c),g=a.trait.utils.extentMax(j.domain()),this},a.rebind(e,n,"on"),e}b.control.brush=c}(d3,d3.trait),function(a,b){function c(a,b){return"l"+a+","+b}function d(a,b,c,d){return"q"+a+","+b+" "+c+","+d}function e(a,b){return"m"+a+","+b}function f(a){return Math.max(.16*a,6)}function g(a,b,f,g,h,i){var j=h.x<.5?1:-1,k=Math.floor(b/2-g-f),l=2*k+2*g,m=Math.floor(a-f-f),n=e(0,0+i)+c(2*j*g,-g-i)+c(0,-k)+d(0,-f,j*f,-f)+c(j*m,0)+d(j*f,0,j*f,f)+c(0,l)+d(0,f,j*-f,f)+c(j*-m,0)+d(j*-f,0,j*-f,-f)+c(0,-k)+"z";
return n}function h(a){a.forEach(function(a){a&&(a.remove=!0)})}function i(a){a.forEach(function(b,c){b&&b.remove&&(b.group.remove(),a[c]=null)})}function j(a){delete a.lastFoci,a.tooltips&&a.tooltips.forEach(function(b,c){b&&(b.group.remove(),a.tooltips[c]=null)})}function k(b,c,d){function e(b){var n=e;b.each(function(b){var e=this,o=a.trait.utils.getTraitCache(e,d);o.tooltips=b.map(function(){return null}),n.onChartMouseOut(e,function(){j(o)}),n.onFocusChange(e,function(d){if(d.length<=0)return j(o),void 0;var p=new a.trait.Point(0,.5);h(o.tooltips),d.forEach(function(d){var g,h=b.indexOf(d.series),i=o.tooltips[h],j=l(c.x1(d.item)),k=c.y1(d.item);c.formatY&&(k=c.formatY(k)),g=j+" "+k,i||(i={newby:!0},i.group=e._container.append("g").attr({id:"tooltip",opacity:0}),i.path=i.group.append("path").attr("fill","darkgray"),i.text=i.group.append("text").attr({"font-family":"monospace","font-size":10,fill:"black","text-rendering":"geometric-precision"}),o.tooltips[h]=i),i.remove=!1,i.text.text(g);var n=i.text.node().getBBox();n.height=2*n.height+2*m,n.width+=2*m+f(n.height),d.rect=new a.trait.Rect(d.point,n,p)}),a.trait.layout.verticalAnchorLeftRight(d,n.chartRect()),d.forEach(function(c){var d=b.indexOf(c.series),e=o.tooltips[d],h=a.rgb(c.color).darker(1.4).toString(),i=c.point.y-c.rect.origin.y,j=f(c.rect.size.height),l=g(c.rect.size.width,c.rect.size.height,k,j,c.rect.anchor,i),n=2*j+m+k,p=c.rect.anchor.x<.5?n:-c.rect.size.width-m-k;e.text.attr("transform","translate("+p+","+0+")"),e.newby?(e.group.attr("transform","translate("+c.rect.origin.x+","+c.rect.origin.y+")"),e.group.transition().attr("opacity",1)):e.group.transition().attr({opacity:1,transform:"translate("+c.rect.origin.x+","+c.rect.origin.y+")"}),e.path.transition().attr({opacity:.72,fill:c.color,stroke:h,d:l}),e.newby=!1}),i(o.tooltips),o.lastFoci=d})})}a.trait.utils.configFloat(c.distance,14),c.axis;var k=4,m=3;return e}var l=a.time.format("%Y-%m-%d");b.focus.tooltip=k}(d3,d3.trait),function(a,b){function c(b,c){function d(){return"top"===g||"bottom"===g}function e(){var a,d={left:2,right:2};return c.legendMargin&&(d.left=c.legendMargin.left||d.left,d.right=c.legendMargin.right||d.right,d.top=c.legendMargin.top,d.bottom=c.legendMargin.bottom),d.left+=b.marginLeft(),d.right+=b.marginRight(),a="margin-left:"+d.left+"px;",a+="margin-right:"+d.right+"px;",d.top&&(a+="margin-top:"+d.top+"px;"),d.bottom&&(a+="margin-bottom:"+d.bottom+"px;"),a}function f(b){var h=f;b.each(function(b){if(!this._legend){var f=c.legendClass?"legend "+c.legendClass:"legend";if(d()){var i=a.select(this);this._legend="top"===g?i.insert("ul","svg"):i.append("ul"),this._legend.attr("style",e()).attr("class",f)}else this._legend=this._container.append("g").classed(f,!0)}var j=c.legendFilter?b.filter(c.legendFilter):b;if(d()){var k=this._legend.selectAll("li").data(j);k.enter().append("li").attr("class","legend-item").style("border-bottom-color",h.color).text(c.seriesLabel)}else{var l=this._legend.selectAll(".legend").data(j);l.enter().append("g").attr("class","legend").attr("transform",function(a,b){return"translate(0,"+20*b+")"}),l.append("rect").attr("x",h.chartWidth()-18).attr("width",18).attr("height",18).style("fill",h.color),l.append("text").attr("x",h.chartWidth()-24).attr("y",9).attr("dy",".35em").style("text-anchor","end").text(c.seriesLabel)}})}var g=c.orient||"top",h=a.dispatch("customHover");return a.rebind(f,h,"on"),f}b.legend.series=c}(d3,d3.trait),function(a,b){function c(b,c,d){var e=a.min(b,function(b){return a.min(c.series(b),c.data)});return e||(e=d?d:0),e}function d(b,c,d){var e=a.max(b,function(b){return a.max(c.series(b),c.data)});return e||(e=d?d:0),e}function e(b,c,d){var e,f,g;return e=b.map(function(b){return a.extent(c.series(b),c.data)}),f=a.min(e,function(a){return a[0]}),g=a.max(e,function(a){return a[1]}),f||g?(f===g&&(f-=1,g+=1),[f,g]):d?d:[0,1]}b.utils||(b.utils={}),b.utils.minFromData=c,b.utils.maxFromData=d,b.utils.extentFromData=e}(d3,d3.trait),function(a,b){function c(a){return n.indexOf(a)>=0}function d(a,b){return{series:a.seriesData,data:a[b]}}function e(b){var c=a.trait.utils.configFloat(b.domainMin,null),d=a.trait.utils.configFloat(b.domainMax,null),e={trend:b.trend};return null!==c&&null!==d?e.domain=[c,d]:null!==c||null!=d?(e.domainMin=c,e.domainMax=d):e.domain=b.domain,e}function f(a,b){var d,e=b.count||1;return d=c(b.interval)?b.interval.offset(a,0-e):a instanceof Date?a.getTime()-b.interval*e:a-b.interval*e}function g(a,c,d){var e,g,h;return a.track===m?(g=new Date,e=f(g,a.domain),h=[e,g]):a.domain&&a.domain.interval?(g=b.utils.maxFromData(c,d),e=f(g,a.domain),h=[e,g]):h=b.utils.extentFromData(c,d),h}function h(a,c,d){if(a.domain)return a.domain;var e;return e=a.trend?g(a,c,d):null!=a.domainMin?[a.domainMin,b.utils.maxFromData(c,d)]:null!=a.domainMax?[b.utils.minFromData(c,d),a.domainMax]:b.utils.extentFromData(c,d)}function i(a,c,d,e,g){var h,i,j,k,l,n;if(a.range(c),d.domain)return a.domain(d.domain),void 0;if(k=a.domain(),l=k[k.length-1],d.trend){var o=d.trend;o.track===m?(i=new Date,h=f(i,o.domain),a.domain([h,i])):o.domain&&o.domain.interval?(i=b.utils.maxFromData(e,g),h=f(l,o.domain),a.domain([h,l]),n=a(i),h=f(i,o.domain),a.domain([h,i]),a.range([c[0],n])):(j=b.utils.extentFromData(e,g),a.domain(j))}else j=b.utils.extentFromData(e,g),a.domain(j)}function j(b,c){function d(a){var b=d;a.each(function(a){var d;e=c.seriesFilter?a.filter(c.seriesFilter):a;var f="x"===g?b.chartWidth():b.chartHeight();i.rangeRoundBands([0,f],.1),d=e[0].map(h),i.domain(d)})}var e,f=c.axis,g=f.charAt(0),h=c[f],i=a.scale.ordinal();return d[f]=function(){return i},d}function k(b,c){function f(b){var d=f;b.each(function(b){g=c.seriesFilter?b.filter(c.seriesFilter):b,m.domain(h(l,g,k)),c.nice&&m.nice(c.nice),m.range(a.trait.utils.getScaleRange(d,j))})}var g,j=c.axis,k=(j.charAt(0),d(c,j)),l=e(c),m=a.time.scale();return b.minRangeMargin(j,c.minRangeMargin),f[j]=function(){return m},f[j+"Domain"]=function(a){l.domain=a,m.domain(a)},f.update=function(c,d){this._super(c,d);var e=a.trait.utils.getScaleRange(b,j);return i(m,e,l,g,k),this},b.onRangeMarginChanged("scaleTime-"+j,f),f}function l(b,c){function f(b){var d=f;b.each(function(b){g=c.seriesFilter?b.filter(c.seriesFilter):b,m.domain(h(l,g,k)),m.range(a.trait.utils.getScaleRange(d,j))})}var g,j=c.axis,k=(j.charAt(0),d(c,j)),l=e(c),m=a.scale.linear();return b.minRangeMargin(c.axis,c.minRangeMargin),f[j]=function(){return m},f[j+"Domain"]=function(a){l.domain=a,m.domain(a)},f.update=function(c,d){this._super(c,d);var e=a.trait.utils.getScaleRange(b,j);return i(m,e,l,g,k),this},b.onRangeMarginChanged("scaleLinear-"+j,f),f}var m="current-time",n=[a.time.second,a.time.minute,a.time.hour,a.time.day,a.time.week,a.time.month,a.time.year];b.scale.ordinal||(b.scale.ordinal={}),b.scale.linear=l,b.scale.ordinal.bars=j,b.scale.time=k}(d3,d3.trait);